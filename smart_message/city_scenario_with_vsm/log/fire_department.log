# Logfile created on 2025-08-25 21:56:37 -0500 by logger.rb/v1.7.0
[2025-08-25 21:56:37.244] INFO  -- base.rb:44 : 🚀 Starting Fire
[2025-08-25 21:56:37.244] INFO  -- base.rb:45 : 📁 Configuration loaded from: fire_department.yml
[2025-08-25 21:56:37.244] INFO  -- base.rb:46 : 🏷️ Service name: fire_department
[2025-08-25 21:56:37.244] INFO  -- base.rb:99 : 📦 Loading required message classes
[2025-08-25 21:56:37.277] WARN  -- base.rb:132 : ⚠️ Could not load message class: messages/EmergencyMedicalResponse (cannot load such file -- /Users/dewayne/sandbox/git_repos/madbomber/experiments/smart_message/city_scenario_with_vsm/messages/EmergencyMedicalResponse)
[2025-08-25 21:56:37.277] WARN  -- base.rb:132 : ⚠️ Could not load message class: messages/RescueRequest (cannot load such file -- /Users/dewayne/sandbox/git_repos/madbomber/experiments/smart_message/city_scenario_with_vsm/messages/RescueRequest)
[2025-08-25 21:56:37.277] INFO  -- base.rb:119 : ✅ Message classes loaded successfully
[2025-08-25 21:56:37.277] INFO  -- base.rb:137 : 🏗️ Initializing VSM capsule
[2025-08-25 21:56:37.293] INFO  -- base.rb:150 : ✅ VSM capsule initialized and ready
[2025-08-25 21:56:37.293] INFO  -- base.rb:164 : 📡 Setting up subscription to emergency_911_message
[2025-08-25 21:56:37.293] INFO  -- base.rb:192 : ✅ Successfully subscribed to emergency_911_message
[2025-08-25 21:56:37.294] INFO  -- base.rb:227 : 💗 Setting up health monitoring
[2025-08-25 21:56:37.294] INFO  -- base.rb:235 : ✅ Health monitoring active
[2025-08-25 21:56:37.294] INFO  -- base.rb:358 : 📊 Setting up statistics logging every 300 seconds
[2025-08-25 21:56:37.294] INFO  -- base.rb:74 : ✅ Fire is fully operational
[2025-08-25 21:56:37.295] INFO  -- base.rb:75 : 🎯 Ready to handle: Respond to medical emergencies involving injuries or accidents, Provide first aid and rescue services, Coordinate with paramedics and other emergency services
[2025-08-25 21:56:37.295] INFO  -- base.rb:415 : 🔄 Starting main service loop
[2025-08-25 21:56:51.293] INFO  -- fire_department.rb:62 : Fire Department ready for service with engines: Engine-1, Engine-2, Engine-3, Ladder-1, Rescue-1
[2025-08-25 21:56:51.293] INFO  -- subscription.rb:131 : [SmartMessage] Subscribed: Messages::HealthCheckMessage with block/proc handler
[2025-08-25 21:56:51.882] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:56:51.998] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:56:52.006] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:56:52.006] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:56:52.011] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:56:52.011] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 14s
[2025-08-25 21:56:56.884] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:56:56.886] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:56:56.896] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:56:56.896] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:56:56.896] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:56:56.896] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 19s
[2025-08-25 21:57:00.564] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (784 bytes)
[2025-08-25 21:57:01.161] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (792 bytes)
[2025-08-25 21:57:01.890] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:01.890] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:01.899] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:01.899] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:01.899] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 24s
[2025-08-25 21:57:01.899] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:57:02.209] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (842 bytes)
[2025-08-25 21:57:02.740] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (848 bytes)
[2025-08-25 21:57:02.741] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (846 bytes)
[2025-08-25 21:57:02.741] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:57:02.742] WARN  -- fire_department.rb:205 : 911 Emergency: transportation_emergency at 987 Cedar Court - Bus crashed into building downtown!
[2025-08-25 21:57:02.742] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:57:02.742] INFO  -- fire_department.rb:378 : Dispatched Engine-1 to transportation_emergency EMG-215702
[2025-08-25 21:57:02.742] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012cd1aab0>
[2025-08-25 21:57:04.039] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (821 bytes)
[2025-08-25 21:57:05.459] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (815 bytes)
[2025-08-25 21:57:06.891] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:06.892] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:06.896] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:06.896] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:57:06.897] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:06.897] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 29s
[2025-08-25 21:57:11.897] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:11.898] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:11.902] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:11.902] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:57:11.902] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:11.902] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 34s
[2025-08-25 21:57:11.934] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (947 bytes)
[2025-08-25 21:57:12.748] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (951 bytes)
[2025-08-25 21:57:13.571] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (823 bytes)
[2025-08-25 21:57:14.157] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (831 bytes)
[2025-08-25 21:57:14.158] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (829 bytes)
[2025-08-25 21:57:14.158] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:57:14.158] WARN  -- fire_department.rb:205 : 911 Emergency: crime at 258 Spruce Boulevard - Break-in in progress! I can see them in my neighbor's house!
[2025-08-25 21:57:14.158] INFO  -- fire_department.rb:378 : Dispatched Engine-2 to crime EMG-215714
[2025-08-25 21:57:14.158] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:57:14.159] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ee50f18>
[2025-08-25 21:57:14.979] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (977 bytes)
[2025-08-25 21:57:15.052] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (813 bytes)
[2025-08-25 21:57:16.469] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (817 bytes)
[2025-08-25 21:57:16.524] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (984 bytes)
[2025-08-25 21:57:16.909] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:16.909] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:16.913] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:16.913] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 39s
[2025-08-25 21:57:16.913] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:16.913] INFO  -- health_monitor.rb:73 : Sent health status: warning (3 engines available, 2 active fires)
[2025-08-25 21:57:17.116] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (821 bytes)
[2025-08-25 21:57:18.234] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (913 bytes)
[2025-08-25 21:57:18.329] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:57:18.329] INFO  -- fire_department.rb:425 : Fire EMG-215702 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 21:57:19.960] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1009 bytes)
[2025-08-25 21:57:21.170] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (815 bytes)
[2025-08-25 21:57:21.656] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (818 bytes)
[2025-08-25 21:57:21.657] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:57:21.657] WARN  -- fire_department.rb:205 : 911 Emergency: hazmat at 654 Maple Road - Chemical spill from overturned truck! Strong fumes!
[2025-08-25 21:57:21.657] WARN  -- fire_department.rb:325 : HAZMAT incident HAZ-215721 - Engine-3, Ladder-1, Rescue-1 dispatched
[2025-08-25 21:57:21.657] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:57:21.658] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012eb1ad30>
[2025-08-25 21:57:21.906] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:21.907] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:21.909] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:21.909] INFO  -- health_monitor.rb:73 : Sent health status: warning (1 engines available, 2 active fires)
[2025-08-25 21:57:21.910] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:21.910] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 44s
[2025-08-25 21:57:25.583] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (831 bytes)
[2025-08-25 21:57:26.052] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:57:26.919] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:26.922] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:26.926] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:26.926] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 49s
[2025-08-25 21:57:26.930] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:26.930] INFO  -- health_monitor.rb:73 : Sent health status: warning (1 engines available, 2 active fires)
[2025-08-25 21:57:27.222] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (835 bytes)
[2025-08-25 21:57:27.345] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:57:27.345] INFO  -- fire_department.rb:425 : Fire EMG-215714 extinguished: Total loss, area secured after 0.2 minutes
[2025-08-25 21:57:29.014] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (951 bytes)
[2025-08-25 21:57:30.335] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (996 bytes)
[2025-08-25 21:57:31.924] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (288 bytes)
[2025-08-25 21:57:31.926] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:31.929] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:31.929] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:57:31.929] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:31.929] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 54s
[2025-08-25 21:57:32.705] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (977 bytes)
[2025-08-25 21:57:34.033] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (991 bytes)
[2025-08-25 21:57:34.056] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (838 bytes)
[2025-08-25 21:57:34.478] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (851 bytes)
[2025-08-25 21:57:35.554] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (956 bytes)
[2025-08-25 21:57:36.362] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:57:36.362] INFO  -- fire_department.rb:425 : Fire HAZ-215721 extinguished: Total loss, area secured after 0.2 minutes
[2025-08-25 21:57:36.927] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:36.927] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:57:36.930] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:36.930] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:57:36.931] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:36.931] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 0m 59s
[2025-08-25 21:57:37.361] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (957 bytes)
[2025-08-25 21:57:41.178] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:57:41.936] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:57:41.936] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:41.939] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:41.939] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 4s
[2025-08-25 21:57:41.941] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:41.941] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:57:44.587] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (794 bytes)
[2025-08-25 21:57:45.016] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (802 bytes)
[2025-08-25 21:57:46.307] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (917 bytes)
[2025-08-25 21:57:46.943] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:57:46.943] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:46.945] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:46.945] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 9s
[2025-08-25 21:57:46.947] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:46.947] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:57:47.406] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (950 bytes)
[2025-08-25 21:57:50.270] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1023 bytes)
[2025-08-25 21:57:51.375] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (995 bytes)
[2025-08-25 21:57:51.480] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (807 bytes)
[2025-08-25 21:57:51.946] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:51.947] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:57:51.949] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:51.949] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:57:51.950] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:51.950] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 14s
[2025-08-25 21:57:52.185] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (835 bytes)
[2025-08-25 21:57:53.098] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (954 bytes)
[2025-08-25 21:57:55.311] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1030 bytes)
[2025-08-25 21:57:56.952] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:57:56.953] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:57:56.955] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:57:56.955] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 19s
[2025-08-25 21:57:56.957] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:57:56.957] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:00.234] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (854 bytes)
[2025-08-25 21:58:01.962] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:01.962] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:01.967] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:01.967] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 24s
[2025-08-25 21:58:01.968] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:01.968] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:03.488] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (844 bytes)
[2025-08-25 21:58:03.593] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (805 bytes)
[2025-08-25 21:58:03.706] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1011 bytes)
[2025-08-25 21:58:04.068] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (838 bytes)
[2025-08-25 21:58:04.582] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (978 bytes)
[2025-08-25 21:58:06.965] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:06.965] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:06.967] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:06.968] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:06.969] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:06.969] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 29s
[2025-08-25 21:58:07.895] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (959 bytes)
[2025-08-25 21:58:09.099] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (966 bytes)
[2025-08-25 21:58:10.727] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (924 bytes)
[2025-08-25 21:58:11.191] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (807 bytes)
[2025-08-25 21:58:11.972] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:11.974] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:11.976] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:11.976] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:11.976] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:11.976] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 34s
[2025-08-25 21:58:12.614] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (979 bytes)
[2025-08-25 21:58:14.601] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (849 bytes)
[2025-08-25 21:58:15.489] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (835 bytes)
[2025-08-25 21:58:16.974] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:16.974] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:16.977] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:16.977] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 39s
[2025-08-25 21:58:16.977] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:16.977] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:19.236] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (836 bytes)
[2025-08-25 21:58:21.595] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (994 bytes)
[2025-08-25 21:58:21.976] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:21.977] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:21.979] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:21.979] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:21.979] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:21.979] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 44s
[2025-08-25 21:58:23.027] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (993 bytes)
[2025-08-25 21:58:23.074] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (861 bytes)
[2025-08-25 21:58:24.198] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:58:25.401] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (973 bytes)
[2025-08-25 21:58:26.648] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1022 bytes)
[2025-08-25 21:58:26.987] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:26.988] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:26.991] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:26.991] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 49s
[2025-08-25 21:58:26.992] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:26.992] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:28.407] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (979 bytes)
[2025-08-25 21:58:29.244] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (825 bytes)
[2025-08-25 21:58:29.492] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (812 bytes)
[2025-08-25 21:58:29.605] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (808 bytes)
[2025-08-25 21:58:30.215] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (814 bytes)
[2025-08-25 21:58:30.216] WARN  -- fire_department.rb:205 : 911 Emergency: hazmat at 147 Birch Way - Chemical spill from overturned truck! Strong fumes!
[2025-08-25 21:58:30.216] WARN  -- fire_department.rb:325 : HAZMAT incident HAZ-215830 - Engine-1, Engine-2, Engine-3 dispatched
[2025-08-25 21:58:30.217] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:58:30.218] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:58:30.218] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ee54438>
[2025-08-25 21:58:30.400] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (949 bytes)
[2025-08-25 21:58:31.990] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:31.992] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:31.995] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:31.995] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 54s
[2025-08-25 21:58:31.996] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:31.996] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:58:36.077] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:58:36.999] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:37.001] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:37.004] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:37.004] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:37.004] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 1m 59s
[2025-08-25 21:58:37.004] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:58:37.204] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (810 bytes)
[2025-08-25 21:58:37.928] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (813 bytes)
[2025-08-25 21:58:37.928] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:58:37.928] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:58:37.929] WARN  -- fire_department.rb:205 : 911 Emergency: medical at 654 Maple Road - Elderly person fell down stairs, bleeding heavily
[2025-08-25 21:58:37.929] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012eb1e9d0>
[2025-08-25 21:58:37.929] INFO  -- fire_department.rb:259 : Dispatched Rescue-1 to medical MED-215837
[2025-08-25 21:58:39.720] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1006 bytes)
[2025-08-25 21:58:40.445] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1018 bytes)
[2025-08-25 21:58:42.000] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:42.001] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:42.003] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:42.003] INFO  -- health_monitor.rb:73 : Sent health status: warning (1 engines available, 2 active fires)
[2025-08-25 21:58:42.005] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:42.005] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 4s
[2025-08-25 21:58:42.672] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (983 bytes)
[2025-08-25 21:58:44.722] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1027 bytes)
[2025-08-25 21:58:45.461] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:58:45.461] INFO  -- fire_department.rb:425 : Fire HAZ-215830 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 21:58:46.413] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (951 bytes)
[2025-08-25 21:58:47.009] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:47.011] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:47.014] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:47.014] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:58:47.014] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:47.014] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 9s
[2025-08-25 21:58:48.497] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:58:48.581] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (998 bytes)
[2025-08-25 21:58:48.612] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (807 bytes)
[2025-08-25 21:58:50.086] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (819 bytes)
[2025-08-25 21:58:52.018] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:52.018] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:52.021] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:52.022] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 14s
[2025-08-25 21:58:52.022] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:52.022] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 21:58:54.473] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:58:54.473] INFO  -- fire_department.rb:425 : Fire MED-215837 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 21:58:57.020] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:58:57.021] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:58:57.024] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:58:57.024] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:58:57.024] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:58:57.024] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 19s
[2025-08-25 21:58:57.495] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (967 bytes)
[2025-08-25 21:58:57.989] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (970 bytes)
[2025-08-25 21:59:00.531] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1027 bytes)
[2025-08-25 21:59:01.251] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (824 bytes)
[2025-08-25 21:59:01.619] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (826 bytes)
[2025-08-25 21:59:02.025] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:02.025] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:02.027] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:02.027] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:02.028] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:02.028] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 24s
[2025-08-25 21:59:02.503] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (840 bytes)
[2025-08-25 21:59:02.522] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (830 bytes)
[2025-08-25 21:59:03.164] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1009 bytes)
[2025-08-25 21:59:03.754] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (451 bytes)
[2025-08-25 21:59:05.056] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (452 bytes)
[2025-08-25 21:59:06.095] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (831 bytes)
[2025-08-25 21:59:07.030] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:07.032] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:07.034] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:07.034] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:07.034] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 29s
[2025-08-25 21:59:07.034] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:08.217] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (828 bytes)
[2025-08-25 21:59:12.039] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:12.040] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:12.043] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:12.043] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 34s
[2025-08-25 21:59:12.044] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:12.044] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:15.223] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1005 bytes)
[2025-08-25 21:59:15.624] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (822 bytes)
[2025-08-25 21:59:16.023] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1034 bytes)
[2025-08-25 21:59:17.040] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:17.041] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:17.044] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:17.044] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 39s
[2025-08-25 21:59:17.046] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:17.046] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:18.292] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1029 bytes)
[2025-08-25 21:59:19.098] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (824 bytes)
[2025-08-25 21:59:19.663] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (827 bytes)
[2025-08-25 21:59:20.691] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (983 bytes)
[2025-08-25 21:59:22.047] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:22.048] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:22.052] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:22.052] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:22.052] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:22.052] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 44s
[2025-08-25 21:59:22.219] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (798 bytes)
[2025-08-25 21:59:22.497] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (971 bytes)
[2025-08-25 21:59:25.261] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (832 bytes)
[2025-08-25 21:59:27.053] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:27.054] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:27.057] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:27.057] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 49s
[2025-08-25 21:59:27.059] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:27.059] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:32.059] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:32.060] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:32.063] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:32.063] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 54s
[2025-08-25 21:59:32.064] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:32.064] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:32.739] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1002 bytes)
[2025-08-25 21:59:34.117] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1029 bytes)
[2025-08-25 21:59:35.109] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (843 bytes)
[2025-08-25 21:59:35.225] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (813 bytes)
[2025-08-25 21:59:35.519] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (794 bytes)
[2025-08-25 21:59:35.633] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (841 bytes)
[2025-08-25 21:59:35.979] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (818 bytes)
[2025-08-25 21:59:35.993] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (816 bytes)
[2025-08-25 21:59:35.994] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:59:35.994] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:59:35.994] WARN  -- fire_department.rb:205 : 911 Emergency: accident at 987 Cedar Court - Multi-car pileup on the highway! At least 5 cars!
[2025-08-25 21:59:35.995] INFO  -- fire_department.rb:354 : Dispatched Ladder-1, Engine-1, Engine-2 to accident MVA-215935
[2025-08-25 21:59:35.995] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ca52620>
[2025-08-25 21:59:35.999] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1030 bytes)
[2025-08-25 21:59:36.083] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (461 bytes)
[2025-08-25 21:59:36.085] WARN  -- fire_department.rb:141 : FIRE EMERGENCY: general fire at 789 Pine Lane (high severity)
[2025-08-25 21:59:36.087] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::FireDispatchMessage via RedisTransport
[2025-08-25 21:59:36.087] INFO  -- fire_department.rb:183 : Dispatched engines Engine-3, Rescue-1 to 789 Pine Lane (691beaab)
[2025-08-25 21:59:37.081] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:37.085] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:37.089] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:37.089] INFO  -- health_monitor.rb:73 : Sent health status: warning (0 engines available, 2 active fires)
[2025-08-25 21:59:37.090] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:37.090] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 2m 59s
[2025-08-25 21:59:38.568] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (995 bytes)
[2025-08-25 21:59:40.944] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (993 bytes)
[2025-08-25 21:59:41.974] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (957 bytes)
[2025-08-25 21:59:42.084] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:42.084] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:42.090] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:42.090] INFO  -- health_monitor.rb:73 : Sent health status: warning (0 engines available, 2 active fires)
[2025-08-25 21:59:42.091] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:42.091] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 4s
[2025-08-25 21:59:43.271] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (830 bytes)
[2025-08-25 21:59:43.863] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (836 bytes)
[2025-08-25 21:59:45.231] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (845 bytes)
[2025-08-25 21:59:46.524] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (822 bytes)
[2025-08-25 21:59:46.644] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (822 bytes)
[2025-08-25 21:59:47.088] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:47.092] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:47.102] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:47.102] INFO  -- health_monitor.rb:73 : Sent health status: warning (0 engines available, 2 active fires)
[2025-08-25 21:59:47.103] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:47.103] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 9s
[2025-08-25 21:59:47.555] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (826 bytes)
[2025-08-25 21:59:48.116] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 21:59:51.547] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (943 bytes)
[2025-08-25 21:59:51.555] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 21:59:51.555] INFO  -- fire_department.rb:425 : Fire MVA-215935 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 21:59:51.556] ERROR -- base.rb:123 : [SmartMessage] Error in message initialization: ArgumentError - The property 'location' is required for Messages::EmergencyResolvedMessage.
[2025-08-25 21:59:51.556] ERROR -- fire_department.rb:428 : Error resolving fire: The property 'location' is required for Messages::EmergencyResolvedMessage.
[2025-08-25 21:59:52.098] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:52.103] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:52.105] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:52.105] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 14s
[2025-08-25 21:59:52.107] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:52.107] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:52.242] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1045 bytes)
[2025-08-25 21:59:55.020] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (973 bytes)
[2025-08-25 21:59:56.024] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (978 bytes)
[2025-08-25 21:59:57.100] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 21:59:57.106] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 21:59:57.114] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 21:59:57.114] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 21:59:57.115] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 21:59:57.115] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 19s
[2025-08-25 21:59:58.622] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1014 bytes)
[2025-08-25 21:59:58.651] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (804 bytes)
[2025-08-25 21:59:59.716] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (810 bytes)
[2025-08-25 21:59:59.719] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 21:59:59.719] WARN  -- fire_department.rb:205 : 911 Emergency: medical at 456 Oak Avenue - Elderly person fell down stairs, bleeding heavily
[2025-08-25 21:59:59.720] INFO  -- fire_department.rb:259 : Dispatched Rescue-1 to medical MED-215959
[2025-08-25 21:59:59.720] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 21:59:59.721] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ba7c638>
[2025-08-25 22:00:00.534] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (858 bytes)
[2025-08-25 22:00:01.235] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (839 bytes)
[2025-08-25 22:00:01.297] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (952 bytes)
[2025-08-25 22:00:02.108] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:02.112] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:02.122] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:02.122] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:00:02.123] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:02.123] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 24s
[2025-08-25 22:00:03.275] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (838 bytes)
[2025-08-25 22:00:07.103] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:07.105] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:07.107] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:07.107] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 29s
[2025-08-25 22:00:07.108] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:07.108] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:00:07.118] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (825 bytes)
[2025-08-25 22:00:08.291] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (828 bytes)
[2025-08-25 22:00:09.006] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (984 bytes)
[2025-08-25 22:00:11.127] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1043 bytes)
[2025-08-25 22:00:11.239] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (802 bytes)
[2025-08-25 22:00:11.944] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (807 bytes)
[2025-08-25 22:00:12.111] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:12.115] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:12.125] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:12.125] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:00:12.126] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:12.126] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 34s
[2025-08-25 22:00:12.583] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:00:12.584] INFO  -- fire_department.rb:425 : Fire MED-215959 extinguished: Total loss, area secured after 0.2 minutes
[2025-08-25 22:00:13.028] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1016 bytes)
[2025-08-25 22:00:13.279] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (796 bytes)
[2025-08-25 22:00:13.806] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (981 bytes)
[2025-08-25 22:00:15.779] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (451 bytes)
[2025-08-25 22:00:16.655] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (841 bytes)
[2025-08-25 22:00:17.128] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:17.134] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:17.140] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:17.140] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:17.140] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:17.140] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 39s
[2025-08-25 22:00:17.542] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (846 bytes)
[2025-08-25 22:00:18.408] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (453 bytes)
[2025-08-25 22:00:21.247] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (852 bytes)
[2025-08-25 22:00:22.127] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:22.129] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:22.142] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:22.142] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:22.142] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:22.142] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 44s
[2025-08-25 22:00:24.126] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (842 bytes)
[2025-08-25 22:00:26.820] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (988 bytes)
[2025-08-25 22:00:27.141] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:27.146] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:27.151] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:27.151] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:27.152] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:27.152] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 49s
[2025-08-25 22:00:28.550] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (841 bytes)
[2025-08-25 22:00:29.881] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (988 bytes)
[2025-08-25 22:00:30.802] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1023 bytes)
[2025-08-25 22:00:31.611] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (954 bytes)
[2025-08-25 22:00:32.151] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:32.157] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:32.160] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:32.160] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 54s
[2025-08-25 22:00:32.161] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:32.161] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:32.287] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (847 bytes)
[2025-08-25 22:00:33.662] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (810 bytes)
[2025-08-25 22:00:33.930] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (995 bytes)
[2025-08-25 22:00:36.254] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (837 bytes)
[2025-08-25 22:00:36.640] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (921 bytes)
[2025-08-25 22:00:37.150] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:37.150] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:37.153] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:37.153] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 3m 59s
[2025-08-25 22:00:37.155] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:37.155] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:42.156] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:42.158] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:42.162] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:42.162] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 4s
[2025-08-25 22:00:42.162] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:42.162] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:00:42.563] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (814 bytes)
[2025-08-25 22:00:43.603] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (448 bytes)
[2025-08-25 22:00:43.608] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (816 bytes)
[2025-08-25 22:00:43.609] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:00:43.609] WARN  -- fire_department.rb:205 : 911 Emergency: accident at 456 Oak Avenue - Multi-car pileup on the highway! At least 5 cars!
[2025-08-25 22:00:43.609] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:00:43.609] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (818 bytes)
[2025-08-25 22:00:43.609] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ca5a780>
[2025-08-25 22:00:43.610] INFO  -- fire_department.rb:354 : Dispatched Ladder-1, Engine-1, Engine-2 to accident MVA-220043
[2025-08-25 22:00:44.131] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (826 bytes)
[2025-08-25 22:00:44.780] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (829 bytes)
[2025-08-25 22:00:46.260] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (818 bytes)
[2025-08-25 22:00:47.166] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:47.168] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:47.171] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:47.171] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 9s
[2025-08-25 22:00:47.171] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:47.171] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:00:47.224] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (821 bytes)
[2025-08-25 22:00:47.225] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:00:47.225] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:00:47.225] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (823 bytes)
[2025-08-25 22:00:47.225] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012f91a160>
[2025-08-25 22:00:47.226] WARN  -- fire_department.rb:205 : 911 Emergency: accident at 258 Spruce Boulevard - Multi-car pileup on the highway! At least 5 cars!
[2025-08-25 22:00:47.226] INFO  -- fire_department.rb:354 : Dispatched Engine-3, Rescue-1 to accident MVA-220047
[2025-08-25 22:00:47.289] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (827 bytes)
[2025-08-25 22:00:47.886] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1026 bytes)
[2025-08-25 22:00:48.874] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1030 bytes)
[2025-08-25 22:00:49.591] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (994 bytes)
[2025-08-25 22:00:51.216] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (968 bytes)
[2025-08-25 22:00:52.172] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:52.174] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:52.176] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:52.177] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 14s
[2025-08-25 22:00:52.177] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:52.177] INFO  -- health_monitor.rb:73 : Sent health status: warning (0 engines available, 2 active fires)
[2025-08-25 22:00:52.673] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (851 bytes)
[2025-08-25 22:00:54.032] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1000 bytes)
[2025-08-25 22:00:54.139] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (832 bytes)
[2025-08-25 22:00:57.175] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:00:57.177] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:00:57.180] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:00:57.180] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 19s
[2025-08-25 22:00:57.180] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:00:57.181] INFO  -- health_monitor.rb:73 : Sent health status: warning (0 engines available, 2 active fires)
[2025-08-25 22:00:57.638] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:00:57.638] INFO  -- fire_department.rb:425 : Fire MVA-220043 extinguished: Total loss, area secured after 0.2 minutes
[2025-08-25 22:00:59.570] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (820 bytes)
[2025-08-25 22:01:01.119] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (968 bytes)
[2025-08-25 22:01:01.297] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (795 bytes)
[2025-08-25 22:01:01.984] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (801 bytes)
[2025-08-25 22:01:01.989] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (799 bytes)
[2025-08-25 22:01:01.990] WARN  -- fire_department.rb:205 : 911 Emergency: accident at 147 Birch Way - Two car collision at the intersection
[2025-08-25 22:01:01.990] INFO  -- fire_department.rb:354 : Dispatched Ladder-1, Engine-1 to accident MVA-220101
[2025-08-25 22:01:01.990] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:01:01.990] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:01:01.990] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012eb3b378>
[2025-08-25 22:01:02.176] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:02.177] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:02.179] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:02.179] INFO  -- health_monitor.rb:73 : Sent health status: warning (1 engines available, 2 active fires)
[2025-08-25 22:01:02.180] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:02.180] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 24s
[2025-08-25 22:01:02.266] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (826 bytes)
[2025-08-25 22:01:03.649] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:01:03.650] INFO  -- fire_department.rb:425 : Fire MVA-220047 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 22:01:03.681] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (821 bytes)
[2025-08-25 22:01:06.569] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1020 bytes)
[2025-08-25 22:01:07.184] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:07.186] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:07.188] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:07.188] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:01:07.188] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:07.188] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 29s
[2025-08-25 22:01:07.344] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1017 bytes)
[2025-08-25 22:01:08.141] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (994 bytes)
[2025-08-25 22:01:09.321] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (998 bytes)
[2025-08-25 22:01:11.022] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (450 bytes)
[2025-08-25 22:01:11.148] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (826 bytes)
[2025-08-25 22:01:11.578] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (846 bytes)
[2025-08-25 22:01:12.191] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (829 bytes)
[2025-08-25 22:01:12.199] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (827 bytes)
[2025-08-25 22:01:12.200] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:12.201] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:01:12.202] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:01:12.203] WARN  -- fire_department.rb:205 : 911 Emergency: crime at 321 Elm Drive - Break-in in progress! I can see them in my neighbor's house!
[2025-08-25 22:01:12.203] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ca59b00>
[2025-08-25 22:01:12.203] INFO  -- fire_department.rb:378 : Dispatched Engine-2 to crime EMG-220112
[2025-08-25 22:01:12.203] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:12.204] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:12.204] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:01:12.206] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:12.206] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 34s
[2025-08-25 22:01:15.308] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (836 bytes)
[2025-08-25 22:01:16.687] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (811 bytes)
[2025-08-25 22:01:17.207] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:17.209] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:17.211] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:17.211] INFO  -- health_monitor.rb:73 : Sent health status: warning (2 engines available, 2 active fires)
[2025-08-25 22:01:17.212] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:17.212] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 39s
[2025-08-25 22:01:18.674] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:01:18.674] INFO  -- fire_department.rb:425 : Fire MVA-220101 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 22:01:19.154] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (972 bytes)
[2025-08-25 22:01:22.216] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:22.220] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:22.220] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:01:22.221] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:22.222] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:22.222] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 44s
[2025-08-25 22:01:22.272] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (799 bytes)
[2025-08-25 22:01:23.264] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (804 bytes)
[2025-08-25 22:01:23.265] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (802 bytes)
[2025-08-25 22:01:23.266] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:01:23.266] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:01:23.266] WARN  -- fire_department.rb:205 : 911 Emergency: crime at 321 Elm Drive - Armed robbery at the corner store!
[2025-08-25 22:01:23.266] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ee9b720>
[2025-08-25 22:01:23.266] INFO  -- fire_department.rb:378 : Dispatched Engine-3 to crime EMG-220123
[2025-08-25 22:01:25.163] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (980 bytes)
[2025-08-25 22:01:25.405] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1017 bytes)
[2025-08-25 22:01:26.194] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (972 bytes)
[2025-08-25 22:01:26.692] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (813 bytes)
[2025-08-25 22:01:27.224] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:27.225] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:27.228] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:27.228] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 49s
[2025-08-25 22:01:27.229] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:27.229] INFO  -- health_monitor.rb:73 : Sent health status: warning (3 engines available, 2 active fires)
[2025-08-25 22:01:27.383] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (1045 bytes)
[2025-08-25 22:01:27.685] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:01:27.685] INFO  -- fire_department.rb:425 : Fire EMG-220112 extinguished: Total loss, area secured after 0.3 minutes
[2025-08-25 22:01:28.319] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (843 bytes)
[2025-08-25 22:01:30.384] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (949 bytes)
[2025-08-25 22:01:31.154] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (841 bytes)
[2025-08-25 22:01:32.229] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:32.231] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:32.235] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:32.235] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 4m 54s
[2025-08-25 22:01:32.236] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:32.236] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:01:32.635] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (844 bytes)
[2025-08-25 22:01:33.279] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (832 bytes)
[2025-08-25 22:01:36.141] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::FireEmergencyMessage (442 bytes)
[2025-08-25 22:01:36.692] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::EmergencyResolvedMessage via RedisTransport
[2025-08-25 22:01:36.692] INFO  -- fire_department.rb:425 : Fire EMG-220123 extinguished: Total loss, area secured after 0.2 minutes
[2025-08-25 22:01:37.243] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:37.245] INFO  -- base.rb:244 : 💗 Received health check from health-department
[2025-08-25 22:01:37.247] INFO  -- base.rb:264 : 💗 Health status sent to health-department
[2025-08-25 22:01:37.247] INFO  -- base.rb:265 :    Metrics: 0 msgs, 100.0% success, uptime: 0h 5m 0s
[2025-08-25 22:01:37.248] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:37.248] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 0 active fires)
[2025-08-25 22:01:37.301] INFO  -- base.rb:378 : 📊 === DEPARTMENT STATISTICS ===
[2025-08-25 22:01:37.301] INFO  -- base.rb:379 : ⏰ Uptime: 0h 5m 0s
[2025-08-25 22:01:37.301] INFO  -- base.rb:380 : 📨 Messages received: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:381 : ✅ Successful operations: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:382 : ❌ Failed operations: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:399 : 📊 ========================
[2025-08-25 22:01:37.301] INFO  -- base.rb:378 : 📊 === DEPARTMENT STATISTICS ===
[2025-08-25 22:01:37.301] INFO  -- base.rb:379 : ⏰ Uptime: 0h 5m 0s
[2025-08-25 22:01:37.301] INFO  -- base.rb:380 : 📨 Messages received: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:381 : ✅ Successful operations: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:382 : ❌ Failed operations: 0
[2025-08-25 22:01:37.301] INFO  -- base.rb:399 : 📊 ========================
[2025-08-25 22:01:38.699] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (793 bytes)
[2025-08-25 22:01:40.060] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (801 bytes)
[2025-08-25 22:01:40.066] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (799 bytes)
[2025-08-25 22:01:40.066] INFO  -- base.rb:177 : 📨 Received emergency_911_message from 911-dispatch
[2025-08-25 22:01:40.066] INFO  -- base.rb:202 : 🎯 Processing emergency_911_message message
[2025-08-25 22:01:40.067] ERROR -- base.rb:185 : 🚨 Failed to handle emergency_911_message: undefined method 'msg_id' for #<SmartMessage::Header:0x000000012ba7c138>
[2025-08-25 22:01:40.067] WARN  -- fire_department.rb:205 : 911 Emergency: accident at 123 Main Street - Two car collision at the intersection
[2025-08-25 22:01:40.067] INFO  -- fire_department.rb:354 : Dispatched Rescue-1, Ladder-1 to accident MVA-220140
[2025-08-25 22:01:42.003] INFO  -- base.rb:431 : 🛑 Shutting down Fire
[2025-08-25 22:01:42.003] INFO  -- base.rb:469 : 📊 === FINAL DEPARTMENT STATISTICS ===
[2025-08-25 22:01:42.003] INFO  -- base.rb:470 : ⏰ Total uptime: 0h 5m 4s
[2025-08-25 22:01:42.003] INFO  -- base.rb:471 : 📨 Total messages processed: 0
[2025-08-25 22:01:42.003] INFO  -- base.rb:472 : ✅ Total successful operations: 0
[2025-08-25 22:01:42.003] INFO  -- base.rb:473 : ❌ Total failed operations: 0
[2025-08-25 22:01:42.003] INFO  -- base.rb:476 : 🎯 Operations success rate: 100.0%
[2025-08-25 22:01:42.003] INFO  -- base.rb:478 : 📊 ==============================
[2025-08-25 22:01:42.003] INFO  -- base.rb:447 : 👋 Fire shutdown complete
[2025-08-25 22:01:42.241] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::HealthCheckMessage (289 bytes)
[2025-08-25 22:01:42.246] INFO  -- messaging.rb:60 : [SmartMessage] Published: Messages::HealthStatusMessage via RedisTransport
[2025-08-25 22:01:42.246] INFO  -- health_monitor.rb:73 : Sent health status: healthy (All engines available, 1 active fires)
[2025-08-25 22:01:42.620] INFO  -- base.rb:168 : [SmartMessage] Received: Messages::Emergency911Message (815 bytes)
